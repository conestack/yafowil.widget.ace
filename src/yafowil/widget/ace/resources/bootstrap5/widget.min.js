var yafowil_ace=function(e,t){"use strict";class i{static initialize(e){t(".ace-editor-wrapper",e).each((function(){let e=t(this);void 0!==window.yafowil_array&&window.yafowil_array.inside_template(e)||new i(e,e.data("yafowil-ace"))}))}constructor(e,i){e.data("yafowil-ace",this),this.elem=e,this.opts=i,this.ed_elem=t(".ace-editor",e),this.textarea=t(".ace-editor-value",e),i.basepath&&ace.config.set("basePath",i.basepath);let a=this.editor=ace.edit(this.ed_elem.attr("id"));this.set_theme(i);let s=a.getSession();s.setMode(`ace/mode/${i.mode}`),s.on("change",this.change_handle.bind(this))}set_theme(e){this.editor.setTheme(`ace/theme/${e.theme}`)}change_handle(e){this.textarea.val(this.editor.getValue())}}class a extends i{static initialize(e){t(".ace-editor-wrapper",e).each((function(){let e=t(this);void 0!==window.yafowil_array&&window.yafowil_array.inside_template(e)||new a(e,e.data("yafowil-ace"))}))}constructor(e,t){super(e,t),this.update_theme=this.update_theme.bind(this),void 0!==window.ts&&window.ts.ajax.attach(this,e),t.dark_theme&&this.observe_theme_change()}set_theme(e){this.themes={light:e.theme,dark:e.dark_theme},this.update_theme(document.documentElement.getAttribute("data-bs-theme"))}observe_theme_change(){const e=document.documentElement;this.observer=new MutationObserver((t=>{for(let i of t)if("attributes"===i.type&&"data-bs-theme"===i.attributeName){const t=e.getAttribute("data-bs-theme");this.update_theme(t)}})),this.observer.observe(e,{attributes:!0})}update_theme(e){const t=this.themes[e]||this.themes.light;this.editor.setTheme(`ace/theme/${t}`)}destroy(){this.observer&&this.observer.disconnect(),this.editor.getSession().off(),this.editor.destroy(),this.editor=null,this.ed_elem=null}}function s(e,t){a.initialize(t)}function o(){void 0!==window.yafowil_array&&window.yafowil_array.on_array_event("on_add",s)}return t((function(){void 0!==window.ts?ts.ajax.register(a.initialize,!0):void 0!==window.bdajax?bdajax.register(a.initialize,!0):a.initialize(),o()})),e.BS5AceWidget=a,e.ace_on_array_add=s,e.register_array_subscribers=o,Object.defineProperty(e,"__esModule",{value:!0}),window.yafowil=window.yafowil||{},window.yafowil.ace=e,e}({},jQuery);
